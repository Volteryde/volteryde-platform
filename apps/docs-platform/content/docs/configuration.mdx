---
title: Configuration
description: Centralized environment configuration for all services
---

# Configuration

Volteryde uses a **centralized configuration system** through the `@volteryde/config` package. All environment variables are managed in a single location and shared across all services.

## Why Centralized Configuration?

- ✅ **Single Source of Truth** - One place for all environment variables
- ✅ **Type Safety** - TypeScript types with Zod validation
- ✅ **Fail Fast** - Invalid configuration detected on startup
- ✅ **Consistent** - All services use the same configuration
- ✅ **Feature Flags** - Built-in feature flag support

## Configuration Package

The `@volteryde/config` package provides validated environment variables to all services.

### Usage in Services

```typescript
import { env, getDatabaseUrl } from '@volteryde/config';

// Access environment variables
console.log(env.DATABASE_HOST); // localhost
console.log(env.PORT); // 3000

// Get database connection URL
const dbUrl = getDatabaseUrl();
// postgresql://postgres:postgres@localhost:5432/volteryde
```

## Environment Variables

All environment variables are defined in the root `.env` file.

### Application

| Variable | Description | Default |
|----------|-------------|---------|
| `NODE_ENV` | Environment (development, staging, production) | `development` |
| `PORT` | Application port | `3000` |

### Database (PostgreSQL)

| Variable | Description | Default |
|----------|-------------|---------|
| `DATABASE_HOST` | PostgreSQL host | `localhost` |
| `DATABASE_PORT` | PostgreSQL port | `5432` |
| `DATABASE_NAME` | Database name | `volteryde` |
| `DATABASE_USERNAME` | Database user | `postgres` |
| `DATABASE_PASSWORD` | Database password | `postgres` |
| `DATABASE_URL` | Full connection URL (optional) | - |

### Redis Cache

| Variable | Description | Default |
|----------|-------------|---------|
| `REDIS_HOST` | Redis host | `localhost` |
| `REDIS_PORT` | Redis port | `6379` |
| `REDIS_PASSWORD` | Redis password (optional) | - |
| `REDIS_URL` | Full Redis URL (optional) | - |

### Temporal Workflows

| Variable | Description | Default |
|----------|-------------|---------|
| `TEMPORAL_ADDRESS` | Temporal server address | `localhost:7233` |
| `TEMPORAL_NAMESPACE` | Temporal namespace | `default` |

### Security & Authentication

| Variable | Description | Default |
|----------|-------------|---------|
| `JWT_SECRET` | JWT signing secret | - |
| `JWT_ISSUER_URI` | JWT issuer | `http://localhost:8080` |
| `JWT_EXPIRATION` | Token expiration (seconds) | `86400` |

### AWS Configuration

| Variable | Description | Required |
|----------|-------------|----------|
| `AWS_REGION` | AWS region | Yes |
| `AWS_ACCESS_KEY_ID` | AWS access key | Production only |
| `AWS_SECRET_ACCESS_KEY` | AWS secret key | Production only |

### External Services

| Variable | Description | Required |
|----------|-------------|----------|
| `PAYSTACK_SECRET_KEY` | Paystack API secret | Yes |
| `PAYSTACK_PUBLIC_KEY` | Paystack public key | Yes |
| `TWILIO_ACCOUNT_SID` | Twilio account SID | Optional |
| `TWILIO_AUTH_TOKEN` | Twilio auth token | Optional |
| `SENDGRID_API_KEY` | SendGrid API key | Optional |

### CORS & Security

| Variable | Description | Default |
|----------|-------------|---------|
| `ALLOWED_ORIGINS` | Comma-separated CORS origins | `http://localhost:3000,http://localhost:3001,http://localhost:3002` |

### Feature Flags

| Variable | Description | Default |
|----------|-------------|---------|
| `ENABLE_TEMPORAL_WORKFLOWS` | Enable Temporal workflows | `true` |
| `ENABLE_REDIS_CACHE` | Enable Redis caching | `true` |
| `ENABLE_METRICS` | Enable metrics collection | `true` |

### Logging

| Variable | Description | Default |
|----------|-------------|---------|
| `LOG_LEVEL` | Logging level | `info` |

## Helper Functions

The config package provides helper functions for common operations:

### Database URL

```typescript
import { getDatabaseUrl } from '@volteryde/config';

const url = getDatabaseUrl();
// postgresql://postgres:postgres@localhost:5432/volteryde
```

### Redis URL

```typescript
import { getRedisUrl } from '@volteryde/config';

const url = getRedisUrl();
// redis://localhost:6379
```

### Environment Checks

```typescript
import { isProduction, isDevelopment } from '@volteryde/config';

if (isProduction()) {
  // Production-specific code
}

if (isDevelopment()) {
  // Development tools
}
```

### CORS Origins

```typescript
import { getCorsOrigins } from '@volteryde/config';

const origins = getCorsOrigins();
// ['http://localhost:3000', 'http://localhost:3001', 'http://localhost:3002']
```

### Feature Flags

```typescript
import { featureFlags } from '@volteryde/config';

if (featureFlags.isTemporalEnabled()) {
  // Use Temporal workflows
}

if (featureFlags.isRedisCacheEnabled()) {
  // Enable caching
}

if (featureFlags.isMetricsEnabled()) {
  // Collect metrics
}
```

## Validation

All environment variables are validated using Zod schemas. Invalid configuration will cause the application to fail on startup with a clear error message:

```bash
❌ Invalid environment variables:
{
  DATABASE_HOST: ['Required'],
  JWT_SECRET: ['Required']
}
Error: Invalid environment variables
```

## Adding New Variables

To add new environment variables:

1. Edit `packages/config/src/env.ts`
2. Add the variable to the `envSchema` object
3. Rebuild the config package: `pnpm --filter @volteryde/config build`
4. Update `.env.example` in the root directory
5. Document the variable here

## Environment-Specific Configuration

### Development

Use the `.env` file in the root directory:

```bash
NODE_ENV=development
DATABASE_HOST=localhost
```

### Staging

Override variables in `.env.staging`:

```bash
NODE_ENV=staging
DATABASE_HOST=staging-db.volteryde.internal
```

### Production

Use AWS Secrets Manager for sensitive values. The config package will automatically load from environment variables set by your deployment system.

## Security Best Practices

- ✅ Never commit `.env` files to version control
- ✅ Use `.env.example` as a template
- ✅ Rotate secrets regularly
- ✅ Use AWS Secrets Manager in production
- ✅ Limit access to production credentials
- ✅ Use different credentials per environment
