---
title: Architecture
description: System architecture and design principles
---

# Architecture

Volteryde is built as a production-grade monorepo with a clear separation of concerns across multiple services, workers, and applications.

## System Overview

```
┌─────────────────────────────────────────────────────────┐
│                  Frontend Applications                   │
│  Mobile (2) + Web Portals (7) = 9 Applications          │
└────────────────────┬────────────────────────────────────┘
                     │
                     ▼
┌─────────────────────────────────────────────────────────┐
│                    API Gateway                           │
│              Load Balancer (AWS ALB)                     │
└────────────────────┬────────────────────────────────────┘
                     │
         ┌───────────┴───────────┐
         ▼                       ▼
┌──────────────────┐    ┌──────────────────┐
│  Spring Boot     │    │     NestJS       │
│  (Java)          │    │  (TypeScript)    │
│                  │    │                  │
│ - Authentication │    │ - Telematics     │
│ - Payments       │    │ - Booking        │
│                  │    │ - Fleet Ops      │
│                  │    │ - Charging       │
└────────┬─────────┘    └────────┬─────────┘
         │                       │
         └───────────┬───────────┘
                     │
         ┌───────────┴───────────┐
         ▼                       ▼
┌──────────────────┐    ┌──────────────────┐
│  Temporal        │    │   Event Bus      │
│  Workers         │    │   (Kafka)        │
└──────────────────┘    └──────────────────┘
         │
         ▼
┌─────────────────────────────────────────────────────────┐
│                    Data Layer                            │
│  PostgreSQL | Redis | InfluxDB | S3                     │
└─────────────────────────────────────────────────────────┘
```

## Core Components

### Backend Services

#### 1. Spring Boot Service (Java)

**Location**: `services/volteryde-springboot`

**Responsibilities**:
- **Authentication Module**: OAuth2, JWT, user management, RBAC
- **Payment Module**: Paystack integration, wallet management, transactions

**Why Java/Spring Boot?**
- Enterprise-grade security frameworks
- Mature payment processing libraries
- Strong type safety for financial transactions
- PCI DSS compliance tooling

#### 2. NestJS Service (TypeScript)

**Location**: `services/volteryde-nest`

**Responsibilities**:
- **Telematics Module**: Real-time GPS tracking, battery monitoring, vehicle diagnostics
- **Booking Module**: Ride reservations, seat management, scheduling
- **Fleet Operations Module**: Vehicle management, maintenance scheduling
- **Charging Infrastructure Module**: Charging station management, session tracking

**Why NestJS?**
- Excellent WebSocket support for real-time features
- Modern async/await patterns
- TypeScript type safety
- Strong dependency injection
- Easy integration with Temporal

### Workers

#### Temporal Workers (TypeScript)

**Location**: `workers/temporal-workers`

**Purpose**: Orchestrate long-running, fault-tolerant workflows

**Workflows**:
- Booking workflow (reserve → pay → confirm → notify)
- Payment workflow with automatic rollback
- Fleet maintenance scheduling
- Driver onboarding with human-in-the-loop

**Benefits**:
- 99.5%+ workflow success rate
- Automatic retries and error handling
- State persistence across failures
- Full audit trail

### Frontend Applications

#### Mobile Apps (React Native)

1. **Passenger App** - `apps/mobile-passenger-app`
   - Book rides
   - Track vehicles in real-time
   - Payment and wallet management
   - Trip history

2. **Driver App** - `apps/mobile-driver-app`
   - Accept ride requests
   - Navigation
   - Earnings tracking
   - Vehicle diagnostics

#### Web Portals (React)

1. **Admin Dashboard** - `apps/web-admin-dashboard`
   - Platform management
   - User administration
   - Analytics and reporting

2. **Fleet Manager Portal** - `apps/web-fleet-manager-portal`
   - Vehicle fleet management
   - Maintenance scheduling
   - Driver assignment

3. **Customer Portal** - `apps/web-customer-portal`
   - Web-based booking
   - Account management
   - Trip history

4. **Driver Portal** - `apps/web-driver-portal`
   - Registration and onboarding
   - Earnings dashboard
   - Document management

5. **Support Dashboard** - `apps/web-support-dashboard`
   - Customer support tools
   - Ticket management
   - User lookup

6. **Corporate Portal** - `apps/web-corporate-portal`
   - B2B account management
   - Bulk booking
   - Billing and invoicing

7. **Station Manager App** - `apps/web-station-manager-app`
   - Charging station operations
   - Session monitoring
   - Usage analytics

### Shared Packages

**Location**: `packages/`

- **@volteryde/config** - Centralized environment configuration
- **@volteryde/shared-types** - TypeScript type definitions
- **@volteryde/ui-components** - Shared React components
- **@volteryde/auth-sdk** - Authentication SDK
- **@volteryde/utils** - Common utilities

## Infrastructure

### AWS Services

- **EKS (Elastic Kubernetes Service)** - Container orchestration
- **RDS PostgreSQL** - Primary database (Multi-AZ)
- **ElastiCache Redis** - Caching and sessions
- **S3** - Object storage
- **CloudFront** - CDN
- **Route53** - DNS
- **Secrets Manager** - Credential management
- **ALB** - Load balancing

### Databases

- **PostgreSQL** - Transactional data (users, bookings, payments)
- **Redis** - Caching, sessions, rate limiting
- **InfluxDB** - Time-series telemetry data (GPS, battery, diagnostics)
- **S3** - File storage (documents, images)

### Message Queue

- **Kafka/RabbitMQ** - Event-driven communication between services

## Design Principles

### 1. Domain-Driven Design (DDD)

Services are organized around business domains:
- Authentication & Security
- Payment Processing
- Telematics & IoT
- Booking & Reservations
- Fleet Operations
- Charging Infrastructure

### 2. Event-Driven Architecture

Services communicate through events:
- Loose coupling
- Async processing
- Scalability
- Resilience

### 3. Microservices

Independent, deployable services:
- Technology diversity (Java + TypeScript)
- Independent scaling
- Fault isolation
- Easier maintenance

### 4. Infrastructure as Code

Everything defined in code:
- **Terraform** for AWS resources
- **Kubernetes manifests** for deployments
- **Docker** for containerization
- Version controlled infrastructure

### 5. Centralized Configuration

Single source of truth:
- `@volteryde/config` package
- Type-safe environment variables
- Feature flags
- Consistent across all services

### 6. Observability First

Built-in monitoring:
- **Prometheus** - Metrics collection
- **Grafana** - Visualization
- **Loki** - Log aggregation
- **Temporal UI** - Workflow monitoring

## Security

- **JWT Authentication** - Stateless auth tokens
- **OAuth2** - Third-party integrations
- **RBAC** - Role-based access control
- **TLS/SSL** - Encrypted communication
- **AWS Secrets Manager** - Credential storage
- **Network Policies** - Kubernetes network isolation
- **Rate Limiting** - DDoS protection

## Scalability

- **Horizontal Pod Autoscaling** - Kubernetes auto-scaling
- **Multi-AZ Deployment** - High availability
- **CDN** - Global content delivery
- **Caching** - Redis for performance
- **Read Replicas** - Database scaling
- **Event-Driven** - Async processing

## Development Workflow

1. **Local Development** - Docker Compose for infrastructure
2. **Feature Branches** - Git flow branching model
3. **Pull Requests** - Code review process
4. **CI/CD** - GitHub Actions automation
5. **Staging** - Pre-production testing
6. **Production** - Blue-green deployments
